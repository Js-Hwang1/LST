# Default Training Configuration

# Output
output_dir: ./checkpoints
experiment_name: fmkv_sidecar

# Optimization
learning_rate: 1.0e-4
weight_decay: 0.01
warmup_steps: 1000
max_steps: 100000

# Batch
batch_size: 32
gradient_accumulation_steps: 1

# Loss weights (Bug #8 Fix: Increased magnitude weight to prevent output collapse)
force_matching_weight: 1.0
consistency_weight: 0.1
output_magnitude_weight: 0.2  # Increased from 0.05 to 0.2

# Regularization
gradient_clip_norm: 1.0
dropout: 0.1

# Precision
mixed_precision: true
dtype: bfloat16

# Checkpointing
save_steps: 1000
eval_steps: 500
save_total_limit: 3

# Logging
log_steps: 10
wandb_project: fmkv
wandb_entity: null
wandb_tags: []

# Data
num_workers: 4
prefetch_factor: 2

# Early stopping (Bug #16 Fix: Further increased patience and relaxed threshold)
early_stopping_patience: 50  # Increased from 20 to 50 (allows ~25k steps before stopping)
early_stopping_threshold: 1.0e-5  # Relaxed from 1e-4 to 1e-5 (smaller improvement needed)

